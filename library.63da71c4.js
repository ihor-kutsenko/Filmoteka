var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},n=e.parcelRequired7c6;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in a){var n=a[e];delete a[e];var i={id:e,exports:{}};return t[e]=i,n.call(i.exports,i,i.exports),i.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},e.parcelRequired7c6=n),n("7Y9D8");const i={library:document.querySelector(".gallery--library"),footerLink:document.querySelector(".footer__link"),footerBackDrop:document.querySelector(".footer__backdrop"),footerCloseBtn:document.querySelector("[data-modal-close]"),watchBtn:document.querySelector(".button-watched"),queueBtn:document.querySelector(".button-queue")};var r=n("9ECFy"),o=n("1GioC"),s=n("3TVVy"),l=n("jiL1b");function c(e,t){const{id:a,poster_path:n,title:i,release_date:r,vote_average:o}=e,s=o.toFixed(1);return`<li class="gallery__item gallery__item--library movie-card" data-id="${a}">\n                  <div class="movie-card__poster-thumb">\n                    <img src="${e.poster_path?`https://image.tmdb.org/t/p/w300${n}`:"https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png"}"\n                        class="movie-card__poster"\n                        alt="${i}"\n                                            />\n                  </div>\n                  <div class="movie-card__wrap">\n                      <h2 class="movie-info-title movie-title-library"> ${i}</h2>\n                      <div class="movie-info-list">\n                      <p class="info-item-genre">${t}</p>\n                        <span class="info-item-slash"> | </span>\n                        <p class="info-item-year">${new Date(Date.parse(r)).getFullYear()||""}</p>\n                        <span class="info-item-vote">${s}</span>\n                      </div>\n                  </div>\n            </li>`}var d=n("fm3FE"),u=n("1RK3b");const p=new(0,r.ThemoviedbAPI);i.watchBtn.classList.add("is-active-library");try{(0,o.spinnerPlay)(),m(),window.addEventListener("scroll",s.scrollFunction)}catch(e){Notify.failure("Ооps, something went wrong, please try again")}finally{(0,o.spinnerStop)()}function y(e){const t=document.querySelector(".js-title-queue"),a=document.querySelector(".js-library-bg-image"),n=document.querySelector("main");e.length>0&&(t.classList.add("visually-hidden"),a.classList.add("visually-hidden"),n.classList.remove("perspective")),0===e.length&&(t.classList.remove("visually-hidden"),a.classList.remove("visually-hidden"),n.classList.add("perspective"))}async function m(){i.library.innerHTML="";const e=(0,u.load)(p.WATCH_KEY);y(e);try{e.map((e=>e.id)).forEach((async e=>{const t=await p.fetchMovieById(e),a=t.genres.map((e=>e.name));a.length>2&&a.splice(2,a.length-1,"Other"),0===a.length&&a.push("Other"),i.library.insertAdjacentHTML("beforeend",c(t,a.join(", "))),i.library.lastElementChild.setAttribute("data-status","watched")}))}catch(e){Notify.failure("Ооps, something went wrong, please try again")}}function v(e,t,a,n,i){const r=(0,u.load)(e),o=t,s=r.find((e=>e.id===o.id));s&&(a.dataset.list=`${i}`,a.textContent=`${n}`),s||a.classList.add("visually-hidden")}i.watchBtn.addEventListener("click",(()=>{i.queueBtn.classList.remove("is-active-library"),i.watchBtn.classList.add("is-active-library"),m()})),i.queueBtn.addEventListener("click",(()=>{i.watchBtn.classList.remove("is-active-library"),i.queueBtn.classList.add("is-active-library"),async function(){(0,o.spinnerPlay)(),i.library.innerHTML="";const e=(0,u.load)(p.QUEUE_KEY);y(e);const t=e.map((e=>e.id));try{t.forEach((async e=>{const t=await p.fetchMovieById(e),a=t.genres.map((e=>e.name));a.length>2&&a.splice(2,a.length-1,"Other"),0===a.length&&a.push("Other"),i.library.insertAdjacentHTML("beforeend",c(t,a.join(", "))),i.library.lastElementChild.setAttribute("data-status","queue")}))}catch(e){console.log(e),Notify.failure("Ооps, something went wrong, please try again")}finally{(0,o.spinnerStop)()}}()})),i.library.addEventListener("click",(async function(e){const t=e.target.closest(".gallery__item");try{(0,o.spinnerPlay)();const e=t.dataset.id,a=t.dataset.status;await p.fetchMovieById(e).then((n=>{const r=n.poster_path?`https://image.tmdb.org/t/p/w300${n.poster_path}`:"https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png",o=new Date(Date.parse(n.release_date)).getFullYear(),s={id:n.id,poster:r,title:n.title,originalTitle:n.original_title,genres:[],popularity:n.popularity.toFixed(1),overview:n.overview,vote_average:n.vote_average.toFixed(1),vote_count:n.vote_count,release_date:o};n.genres.forEach((e=>{s.genres.push(e.name)})),s.genres=s.genres.join(", "),(0,d.getTrailer)(e,p),(0,l.createModalMarkUp)(s);const c=document.querySelector(".lightbox-modal__watched-button"),m=document.querySelector(".lightbox-modal__queque-button");c.addEventListener("click",(function(e){const n=e.target.dataset.btn;(0,u.removeLocal)(p.WATCH_KEY,n),e.target.textContent="Removed from Watched",e.target.disabled=!0,e.target.dataset.list===a&&t.remove();i.watchBtn.classList.contains("is-active-library")?y((0,u.load)(p.WATCH_KEY)):y((0,u.load)(p.QUEUE_KEY))})),m.addEventListener("click",(function(e){const n=e.target.dataset.btn;(0,u.removeLocal)(p.QUEUE_KEY,n),e.target.textContent="Removed from Queue",e.target.disabled=!0,e.target.dataset.list===a&&t.remove();i.watchBtn.classList.contains("is-active-library")?y((0,u.load)(p.WATCH_KEY)):y((0,u.load)(p.QUEUE_KEY))})),v(p.WATCH_KEY,s,c,"Remove from Watched","watched"),v(p.QUEUE_KEY,s,m,"Remove from Queue","queue")}))}catch(e){console.log(e),Notify.failure("Ооps, something went wrong, please try again")}finally{(0,o.spinnerStop)()}}));
//# sourceMappingURL=library.63da71c4.js.map
