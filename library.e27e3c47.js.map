{"mappings":"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","sources":["src/javascript/library.js","src/javascript/libraryRefs.js","src/javascript/renderLibraryMarkUp.js","src/javascript/libraryTheme.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport { libraryRefs } from './libraryRefs';\nimport { ThemoviedbAPI } from './themoviedbAPI';\nimport { spinnerPlay, spinnerStop } from './spiner';\nimport { scrollFunction } from './scroll';\nimport { createModalMarkUp } from './renderModalMarkUp';\nimport { renderLibraryMarkup } from './renderLibraryMarkUp';\nimport { getTrailer } from './getTrailer';\nimport { load, removeLocal } from './localStorage';\nimport { libraryCheckBox, onChange, isTheme } from './libraryTheme';\n\n\n\n\n\nconst themoviedbAPI = new ThemoviedbAPI();\n\nlibraryRefs.watchBtn.classList.add('is-active-library');\n\n\ntry {\n  spinnerPlay();\n  renderWatchedMovies();\n  window.addEventListener('scroll', scrollFunction);\n\n} catch (error) {\n  Notiflix.Notify.failure('Ооps, something went wrong, please try again');\n} finally {\n  spinnerStop();\n}\n\nlibraryRefs.watchBtn.addEventListener('click', () => {\n  libraryRefs.queueBtn.classList.remove('is-active-library');\n  libraryRefs.watchBtn.classList.add('is-active-library');\n  renderWatchedMovies();\n});\n\nlibraryRefs.queueBtn.addEventListener('click', () => {\n  libraryRefs.watchBtn.classList.remove('is-active-library');\n  libraryRefs.queueBtn.classList.add('is-active-library');\n  renderQueueMovies();\n});\n\nlibraryRefs.library.addEventListener('click', onMovieCardClick);\n\n\n// export?\n function displayBg(array) {\n  const emptyTitle = document.querySelector('.js-title-queue');\n  const emptyImg = document.querySelector('.js-library-bg-image');\n  const mainEl = document.querySelector('main');\n  if (array.length > 0) {\n    emptyTitle.classList.add('visually-hidden');\n    emptyImg.classList.add('visually-hidden');\n    mainEl.classList.remove('perspective');\n  }\n  if (array.length === 0) {\n    emptyTitle.classList.remove('visually-hidden');\n    emptyImg.classList.remove('visually-hidden');\n    mainEl.classList.add('perspective');\n  }\n}\n\n// export?\n async function renderWatchedMovies() {\n  libraryRefs.library.innerHTML = '';\n  const watchedMovies = load(themoviedbAPI.WATCH_KEY);\n  displayBg(watchedMovies);\n  try {\n    const watchedMoviesIds = watchedMovies.map(movie => movie.id);\n    watchedMoviesIds.forEach(async id => {\n      const movie = await themoviedbAPI.fetchMovieById(id);\n      const genre = movie.genres.map(genre => genre.name);\n      if (genre.length > 2) {\n        genre.splice(2, genre.length - 1, 'Other');\n      }\n      if (genre.length === 0) {\n        genre.push('Other');\n      }\n      libraryRefs.library.insertAdjacentHTML(\n        'beforeend',\n        renderLibraryMarkup(movie, genre.join(', '))\n      );\n      libraryRefs.library.lastElementChild.setAttribute('data-status', 'watched');\n    });\n  } catch (error) {\n    Notiflix.Notify.failure('Ооps, something went wrong, please try again');\n  }\n}\n\n\n// export?\n async function renderQueueMovies() {\n  spinnerPlay();\n  libraryRefs.library.innerHTML = '';\n  const queueMovies = load(themoviedbAPI.QUEUE_KEY);\n  displayBg(queueMovies);\n  const queueMoviesIDes = queueMovies.map(movie => movie.id);\n  try {\n    queueMoviesIDes.forEach(async id => {\n      const movie = await themoviedbAPI.fetchMovieById(id);\n      const genre = movie.genres.map(genre => genre.name);\n      if (genre.length > 2) {\n        genre.splice(2, genre.length - 1, 'Other');\n      }\n      if (genre.length === 0) {\n        genre.push('Other');\n      }\n      libraryRefs.library.insertAdjacentHTML(\n        'beforeend',\n        renderLibraryMarkup(movie, genre.join(', '))\n      );\n      libraryRefs.library.lastElementChild.setAttribute('data-status', 'queue');\n    });\n  } catch (error) {\n    console.log(error);\n    Notiflix.Notify.failure('Ооps, something went wrong, please try again');\n  } finally {\n    spinnerStop();\n  }\n}\n\n\n// click card\nasync function onMovieCardClick(event) {\n  const movieCard = event.target.closest('.gallery__item');\n  try {\n    spinnerPlay();\n    const movieId = movieCard.dataset.id;\n\n    const movieStatus = movieCard.dataset.status;\n\n    await themoviedbAPI.fetchMovieById(movieId).then(data => {\n      const posterPath = data.poster_path\n        ? `https://image.tmdb.org/t/p/w300${data.poster_path}`\n        : `https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png`;\n      const releaseYear = new Date(Date.parse(data.release_date)).getFullYear();\n      const filmData = {\n        id: data.id,\n        poster: posterPath,\n        title: data.title,\n        originalTitle: data.original_title,\n        genres: [],\n        popularity: data.popularity.toFixed(1),\n        overview: data.overview,\n        vote_average: data.vote_average.toFixed(1),\n        vote_count: data.vote_count,\n        release_date: releaseYear,\n      };\n\n      data.genres.forEach(genre => {\n        filmData.genres.push(genre.name);\n      });\n      filmData.genres = filmData.genres.join(', ');\n\n      getTrailer(movieId, themoviedbAPI);\n      createModalMarkUp(filmData);\n\n      const removeFromWatchedBtn = document.querySelector(\n        '.lightbox-modal__watched-button'\n      );\n      const removeFromQuequeBtn = document.querySelector(\n        '.lightbox-modal__queque-button'\n      );\n\n      removeFromWatchedBtn.addEventListener('click', onRemoveFromWatchedClick);\n      removeFromQuequeBtn.addEventListener('click', onRemoveFromQueueClick);\n\n      checkLocalStorageLibrary(\n        themoviedbAPI.WATCH_KEY,\n        filmData,\n        removeFromWatchedBtn,\n        'Remove from Watched',\n        'watched'\n      );\n\n      checkLocalStorageLibrary(\n        themoviedbAPI.QUEUE_KEY,\n        filmData,\n        removeFromQuequeBtn,\n        'Remove from Queue',\n        'queue'\n      );\n\n      function onRemoveFromWatchedClick(e) {\n        const movieId = e.target.dataset.btn;\n\n        removeLocal(themoviedbAPI.WATCH_KEY, movieId);\n        e.target.textContent = 'Removed from Watched';\n        e.target.disabled = true;\n        if (e.target.dataset.list === movieStatus) {\n          movieCard.remove();\n        }\n        if (libraryRefs.watchBtn.classList.contains('is-active-library')) {\n          displayBg(load(themoviedbAPI.WATCH_KEY));\n        } else {\n          displayBg(load(themoviedbAPI.QUEUE_KEY));\n        }\n      }\n\n      function onRemoveFromQueueClick(e) {\n        const movieId = e.target.dataset.btn;\n        removeLocal(themoviedbAPI.QUEUE_KEY, movieId);\n        e.target.textContent = 'Removed from Queue';\n        e.target.disabled = true;\n        if (e.target.dataset.list === movieStatus) {\n          movieCard.remove();\n        }\n        if (libraryRefs.watchBtn.classList.contains('is-active-library')) {\n          displayBg(load(themoviedbAPI.WATCH_KEY));\n        } else {\n          displayBg(load(themoviedbAPI.QUEUE_KEY));\n        }\n      }\n    });\n  } catch (error) {\n    console.log(error);\n    Notiflix.Notify.failure('Ооps, something went wrong, please try again');\n  } finally {\n    spinnerStop();\n  }\n}\n\nfunction checkLocalStorageLibrary(key, filmData, btn, btnText, status) {\n  const locStorage = load(key);\n  const currentFilm = filmData;\n  const includesFilm = locStorage.find(film => film.id === currentFilm.id);\n\n  if (includesFilm) {\n    btn.dataset.list = `${status}`;\n    btn.textContent = `${btnText}`;\n  }\n  if (!includesFilm) {\n    btn.classList.add('visually-hidden');\n  }\n}\n\n// theme\nlibraryCheckBox.addEventListener('change', onChange);\nisTheme();","export const libraryRefs = {\n  library: document.querySelector('.gallery--library'),\n  footerLink: document.querySelector('.footer__link'),\n  footerBackDrop: document.querySelector('.footer__backdrop'),\n  footerCloseBtn: document.querySelector('[data-modal-close]'),\n  watchBtn: document.querySelector('.button-watched'),\n  queueBtn: document.querySelector('.button-queue'),\n}","export function renderLibraryMarkup(data, genres) {\n  const { id, poster_path, title, release_date, vote_average } = data;\n  const votes = vote_average.toFixed(1);\n  const posterPath = data.poster_path\n    ? `https://image.tmdb.org/t/p/w300${poster_path}`\n    : `https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png`;\n  const releaseYear = new Date(Date.parse(release_date)).getFullYear() || '';\n\n  return `<li class=\"gallery__item gallery__item--library movie-card\" data-id=\"${id}\">\n                  <div class=\"movie-card__poster-thumb\">\n                    <img src=\"${posterPath}\"\n                        class=\"movie-card__poster\"\n                        alt=\"${title}\"\n                                            />\n                  </div>\n                  <div class=\"movie-card__wrap\">\n                      <h2 class=\"movie-info-title movie-title-library\"> ${title}</h2>\n                      <div class=\"movie-info-list\">\n                      <p class=\"info-item-genre\">${genres}</p>\n                        <span class=\"info-item-slash\"> | </span>\n                        <p class=\"info-item-year\">${releaseYear}</p>\n                        <span class=\"info-item-vote\">${votes}</span>\n                      </div>\n                  </div>\n            </li>`;\n}\n","const Theme = {\n  LIGHT: 'light-theme',\n  DARK: 'dark-theme',\n};\n\nconst STORAGE_KEY = 'themeKeyLibrary';\n\nexport const libraryCheckBox = document.querySelector('.theme-switch__toggle');\nconst body = document.querySelector('body');\n\nexport function onChange(event) {\n  if (event.target.checked) {\n    body.classList.add('dark-theme');\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(Theme.DARK));\n  } else {\n    body.classList.remove('dark-theme');\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(Theme.LIGHT));\n  }\n}\n\nexport function isTheme() {\n  const saveTheme = localStorage.getItem(STORAGE_KEY);\n\n  if (!saveTheme) {\n    body.classList.remove('dark-theme');\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(Theme.LIGHT));\n    libraryCheckBox.checked = false;\n  } else {\n    const parseTheme = JSON.parse(saveTheme);\n    body.classList.toggle('dark-theme', parseTheme === Theme.DARK);\n    libraryCheckBox.checked = parseTheme === Theme.DARK;\n  }\n}\n"],"names":["$7Y9D8","parcelRequire","$acf97af8bdf3ba18$export$cb739650b542b55d","library","document","querySelector","footerLink","footerBackDrop","footerCloseBtn","watchBtn","queueBtn","$ba5fe8ed849660f2$export$271debc1213d424c","data","genres","id","poster_path","title","release_date","vote_average","votes","toFixed","Date","parse","getFullYear","$e88dd521e882802b$var$Theme","$e88dd521e882802b$export$ef6befc012be2063","$e88dd521e882802b$var$body","$a4121ea71a4b503a$var$themoviedbAPI","$9ECFy","ThemoviedbAPI","classList","add","$1GioC","spinnerPlay","$a4121ea71a4b503a$var$renderWatchedMovies","window","addEventListener","$3TVVy","scrollFunction","error","$parcel$interopDefault","Notify","failure","spinnerStop","$a4121ea71a4b503a$var$displayBg","array","emptyTitle","emptyImg","mainEl","length","remove","async","innerHTML","watchedMovies","$jInTj","load","WATCH_KEY","map","movie","forEach","fetchMovieById","genre1","genre","name","splice","push","insertAdjacentHTML","join","lastElementChild","setAttribute","$a4121ea71a4b503a$var$checkLocalStorageLibrary","key","filmData","btn","btnText","status","locStorage","currentFilm","includesFilm","find","film","dataset","list","textContent","queueMovies","QUEUE_KEY","queueMoviesIDes","genre2","error1","console","log","$a4121ea71a4b503a$var$renderQueueMovies","event","movieCard","target","closest","movieId1","movieStatus","then","posterPath","releaseYear","poster","originalTitle","original_title","popularity","overview","vote_count","$fm3FE","getTrailer","$jiL1b","createModalMarkUp","removeFromWatchedBtn","removeFromQuequeBtn","e","movieId","removeLocal","disabled","contains","error2","checked","localStorage","setItem","JSON","stringify","saveTheme","getItem","parseTheme","toggle"],"version":3,"file":"library.e27e3c47.js.map"}