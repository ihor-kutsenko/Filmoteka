{"mappings":"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","sources":["src/javascript/library.js","src/javascript/libraryRefs.js","src/javascript/renderLibraryMarkUp.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport { libraryRefs } from './libraryRefs';\nimport { ThemoviedbAPI } from './themoviedbAPI';\nimport { spinnerPlay, spinnerStop } from './spiner';\nimport { scrollFunction } from './scroll';\nimport { createModalMarkUp } from './renderModalMarkUp';\nimport { renderLibraryMarkup } from './renderLibraryMarkUp';\nimport { getTrailer } from './getTrailer';\nimport {  load, removeLocal } from './localStorageuse';\n\n\n\n// fised bug\n\nconst themoviedbAPI = new ThemoviedbAPI();\n\nlibraryRefs.watchBtn.classList.add('is-active-library');\n\n\ntry {\n  spinnerPlay();\n  renderWatchedMovies();\n  window.addEventListener('scroll', scrollFunction);\n\n} catch (error) {\n  Notify.failure('Ооps, something went wrong, please try again');\n} finally {\n  spinnerStop();\n}\n\nlibraryRefs.watchBtn.addEventListener('click', () => {\n  libraryRefs.queueBtn.classList.remove('is-active-library');\n  libraryRefs.watchBtn.classList.add('is-active-library');\n  renderWatchedMovies();\n});\n\nlibraryRefs.queueBtn.addEventListener('click', () => {\n  libraryRefs.watchBtn.classList.remove('is-active-library');\n  libraryRefs.queueBtn.classList.add('is-active-library');\n  renderQueueMovies();\n});\n\nlibraryRefs.library.addEventListener('click', onMovieCardClick);\n\n\n// export?\n function displayBg(array) {\n  const emptyTitle = document.querySelector('.js-title-queue');\n  const emptyImg = document.querySelector('.js-library-bg-image');\n  const mainEl = document.querySelector('main');\n  if (array.length > 0) {\n    emptyTitle.classList.add('visually-hidden');\n    emptyImg.classList.add('visually-hidden');\n    mainEl.classList.remove('perspective');\n  }\n  if (array.length === 0) {\n    emptyTitle.classList.remove('visually-hidden');\n    emptyImg.classList.remove('visually-hidden');\n    mainEl.classList.add('perspective');\n  }\n}\n\n// export?\n async function renderWatchedMovies() {\n  libraryRefs.library.innerHTML = '';\n  const watchedMovies = load(themoviedbAPI.WATCH_KEY);\n  displayBg(watchedMovies);\n  try {\n    const watchedMoviesIds = watchedMovies.map(movie => movie.id);\n    watchedMoviesIds.forEach(async id => {\n      const movie = await themoviedbAPI.fetchMovieById(id);\n      const genre = movie.genres.map(genre => genre.name);\n      if (genre.length > 2) {\n        genre.splice(2, genre.length - 1, 'Other');\n      }\n      if (genre.length === 0) {\n        genre.push('Other');\n      }\n      libraryRefs.library.insertAdjacentHTML(\n        'beforeend',\n        renderLibraryMarkup(movie, genre.join(', '))\n      );\n      libraryRefs.library.lastElementChild.setAttribute('data-status', 'watched');\n    });\n  } catch (error) {\n    Notify.failure('Ооps, something went wrong, please try again');\n  }\n}\n\n\n// export?\n async function renderQueueMovies() {\n  spinnerPlay();\n  libraryRefs.library.innerHTML = '';\n  const queueMovies = load(themoviedbAPI.QUEUE_KEY);\n  displayBg(queueMovies);\n  const queueMoviesIDes = queueMovies.map(movie => movie.id);\n  try {\n    queueMoviesIDes.forEach(async id => {\n      const movie = await themoviedbAPI.fetchMovieById(id);\n      const genre = movie.genres.map(genre => genre.name);\n      if (genre.length > 2) {\n        genre.splice(2, genre.length - 1, 'Other');\n      }\n      if (genre.length === 0) {\n        genre.push('Other');\n      }\n      libraryRefs.library.insertAdjacentHTML(\n        'beforeend',\n        renderLibraryMarkup(movie, genre.join(', '))\n      );\n      libraryRefs.library.lastElementChild.setAttribute('data-status', 'queue');\n    });\n  } catch (error) {\n    console.log(error);\n    Notify.failure('Ооps, something went wrong, please try again');\n  } finally {\n    spinnerStop();\n  }\n}\n\n\n// click card\nasync function onMovieCardClick(event) {\n  const movieCard = event.target.closest('.gallery__item');\n  try {\n    spinnerPlay();\n    const movieId = movieCard.dataset.id;\n\n    const movieStatus = movieCard.dataset.status;\n\n    await themoviedbAPI.fetchMovieById(movieId).then(data => {\n      const posterPath = data.poster_path\n        ? `https://image.tmdb.org/t/p/w300${data.poster_path}`\n        : `https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png`;\n      const releaseYear = new Date(Date.parse(data.release_date)).getFullYear();\n      const filmData = {\n        id: data.id,\n        poster: posterPath,\n        title: data.title,\n        originalTitle: data.original_title,\n        genres: [],\n        popularity: data.popularity.toFixed(1),\n        overview: data.overview,\n        vote_average: data.vote_average.toFixed(1),\n        vote_count: data.vote_count,\n        release_date: releaseYear,\n      };\n\n      data.genres.forEach(genre => {\n        filmData.genres.push(genre.name);\n      });\n      filmData.genres = filmData.genres.join(', ');\n\n      getTrailer(movieId, themoviedbAPI);\n      createModalMarkUp(filmData);\n\n      const removeFromWatchedBtn = document.querySelector(\n        '.lightbox-modal__watched-button'\n      );\n      const removeFromQuequeBtn = document.querySelector(\n        '.lightbox-modal__queque-button'\n      );\n\n      removeFromWatchedBtn.addEventListener('click', onRemoveFromWatchedClick);\n      removeFromQuequeBtn.addEventListener('click', onRemoveFromQueueClick);\n\n      checkLocalStorageLibrary(\n        themoviedbAPI.WATCH_KEY,\n        filmData,\n        removeFromWatchedBtn,\n        'Remove from Watched',\n        'watched'\n      );\n\n      checkLocalStorageLibrary(\n        themoviedbAPI.QUEUE_KEY,\n        filmData,\n        removeFromQuequeBtn,\n        'Remove from Queue',\n        'queue'\n      );\n\n      function onRemoveFromWatchedClick(e) {\n        const movieId = e.target.dataset.btn;\n\n        removeLocal(themoviedbAPI.WATCH_KEY, movieId);\n        e.target.textContent = 'Removed from Watched';\n        e.target.disabled = true;\n        if (e.target.dataset.list === movieStatus) {\n          movieCard.remove();\n        }\n        if (libraryRefs.watchBtn.classList.contains('is-active-library')) {\n          displayBg(load(themoviedbAPI.WATCH_KEY));\n        } else {\n          displayBg(load(themoviedbAPI.QUEUE_KEY));\n        }\n      }\n\n      function onRemoveFromQueueClick(e) {\n        const movieId = e.target.dataset.btn;\n        removeLocal(themoviedbAPI.QUEUE_KEY, movieId);\n        e.target.textContent = 'Removed from Queue';\n        e.target.disabled = true;\n        if (e.target.dataset.list === movieStatus) {\n          movieCard.remove();\n        }\n        if (libraryRefs.watchBtn.classList.contains('is-active-library')) {\n          displayBg(load(themoviedbAPI.WATCH_KEY));\n        } else {\n          displayBg(load(themoviedbAPI.QUEUE_KEY));\n        }\n      }\n    });\n  } catch (error) {\n    console.log(error);\n    Notify.failure('Ооps, something went wrong, please try again');\n  } finally {\n    spinnerStop();\n  }\n}\n\nfunction checkLocalStorageLibrary(key, filmData, btn, btnText, status) {\n  const locStorage = load(key);\n  const currentFilm = filmData;\n  const includesFilm = locStorage.find(film => film.id === currentFilm.id);\n\n  if (includesFilm) {\n    btn.dataset.list = `${status}`;\n    btn.textContent = `${btnText}`;\n  }\n  if (!includesFilm) {\n    btn.classList.add('visually-hidden');\n  }\n}","export const libraryRefs = {\n  library: document.querySelector('.gallery--library'),\n  footerLink: document.querySelector('.footer__link'),\n  footerBackDrop: document.querySelector('.footer__backdrop'),\n  footerCloseBtn: document.querySelector('[data-modal-close]'),\n  watchBtn: document.querySelector('.button-watched'),\n  queueBtn: document.querySelector('.button-queue'),\n}","export function renderLibraryMarkup(data, genres) {\n  const { id, poster_path, title, release_date, vote_average } = data;\n  const votes = vote_average.toFixed(1);\n  const posterPath = data.poster_path\n    ? `https://image.tmdb.org/t/p/w300${poster_path}`\n    : `https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png`;\n  const releaseYear = new Date(Date.parse(release_date)).getFullYear() || '';\n\n  return `<li class=\"gallery__item gallery__item--library movie-card\" data-id=\"${id}\">\n                  <div class=\"movie-card__poster-thumb\">\n                    <img src=\"${posterPath}\"\n                        class=\"movie-card__poster\"\n                        alt=\"${title}\"\n                                            />\n                  </div>\n                  <div class=\"movie-card__wrap\">\n                      <h2 class=\"movie-info-title movie-title-library\"> ${title}</h2>\n                      <div class=\"movie-info-list\">\n                      <p class=\"info-item-genre\">${genres}</p>\n                        <span class=\"info-item-slash\"> | </span>\n                        <p class=\"info-item-year\">${releaseYear}</p>\n                        <span class=\"info-item-vote\">${votes}</span>\n                      </div>\n                  </div>\n            </li>`;\n}\n"],"names":["parcelRequire","$acf97af8bdf3ba18$export$cb739650b542b55d","library","document","querySelector","footerLink","footerBackDrop","footerCloseBtn","watchBtn","queueBtn","$ba5fe8ed849660f2$export$271debc1213d424c","data","genres","id","poster_path","title","release_date","vote_average","votes","toFixed","Date","parse","getFullYear","$a4121ea71a4b503a$var$themoviedbAPI","$9ECFy","ThemoviedbAPI","classList","add","$1GioC","spinnerPlay","$a4121ea71a4b503a$var$renderWatchedMovies","window","addEventListener","$3TVVy","scrollFunction","error","Notify","failure","spinnerStop","$a4121ea71a4b503a$var$displayBg","array","emptyTitle","emptyImg","mainEl","length","remove","async","innerHTML","watchedMovies","$1RK3b","load","WATCH_KEY","map","movie","forEach","fetchMovieById","genre1","genre","name","splice","push","insertAdjacentHTML","join","lastElementChild","setAttribute","$a4121ea71a4b503a$var$checkLocalStorageLibrary","key","filmData","btn","btnText","status","locStorage","currentFilm","includesFilm","find","film","dataset","list","textContent","queueMovies","QUEUE_KEY","queueMoviesIDes","genre2","error1","console","log","$a4121ea71a4b503a$var$renderQueueMovies","event","movieCard","target","closest","movieId1","movieStatus","then","posterPath","releaseYear","poster","originalTitle","original_title","popularity","overview","vote_count","$fm3FE","getTrailer","$jiL1b","createModalMarkUp","removeFromWatchedBtn","removeFromQuequeBtn","e","movieId","removeLocal","disabled","contains","error2"],"version":3,"file":"library.63da71c4.js.map"}