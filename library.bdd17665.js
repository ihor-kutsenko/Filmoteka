!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},a={},r=t.parcelRequired7c6;null==r&&((r=function(e){if(e in n)return n[e].exports;if(e in a){var t=a[e];delete a[e];var r={id:e,exports:{}};return n[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},t.parcelRequired7c6=r);var i=r("bpxeT"),o=r("2TvXO");r("6JpON");var s={library:document.querySelector(".gallery--library"),footerLink:document.querySelector(".footer__link"),footerBackDrop:document.querySelector(".footer__backdrop"),footerCloseBtn:document.querySelector("[data-modal-close]"),watchBtn:document.querySelector(".button-watched"),queueBtn:document.querySelector(".button-queue")},c=r("X3bd8"),l=r("ddUeE"),u=r("dKhQL"),d=r("d1Qha");function p(e,t){var n=e.id,a=e.poster_path,r=e.title,i=e.release_date,o=e.vote_average.toFixed(1),s=e.poster_path?"https://image.tmdb.org/t/p/w300".concat(a):"https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png",c=new Date(Date.parse(i)).getFullYear()||"";return'<li class="gallery__item gallery__item--library movie-card" data-id="'.concat(n,'">\n                  <div class="movie-card__poster-thumb">\n                    <img src="').concat(s,'"\n                        class="movie-card__poster"\n                        alt="').concat(r,'"\n                                            />\n                  </div>\n                  <div class="movie-card__wrap">\n                      <h2 class="movie-info-title movie-title-library"> ').concat(r,'</h2>\n                      <div class="movie-info-list">\n                      <p class="info-item-genre">').concat(t,'</p>\n                        <span class="info-item-slash"> | </span>\n                        <p class="info-item-year">').concat(c,'</p>\n                        <span class="info-item-vote">').concat(o,"</span>\n                      </div>\n                  </div>\n            </li>")}var v=r("2doPt"),f=r("hK462"),h=new(0,c.ThemoviedbAPI);s.watchBtn.classList.add("is-active-library");try{(0,l.spinnerPlay)(),y(),window.addEventListener("scroll",u.scrollFunction)}catch(e){Notify.failure("Ооps, something went wrong, please try again")}finally{(0,l.spinnerStop)()}function m(e){var t=document.querySelector(".js-title-queue"),n=document.querySelector(".js-library-bg-image"),a=document.querySelector("main");e.length>0&&(t.classList.add("visually-hidden"),n.classList.add("visually-hidden"),a.classList.remove("perspective")),0===e.length&&(t.classList.remove("visually-hidden"),n.classList.remove("visually-hidden"),a.classList.add("perspective"))}function y(){return g.apply(this,arguments)}function g(){return g=e(i)(e(o).mark((function t(){var n;return e(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.library.innerHTML="",m(n=(0,f.load)(h.WATCH_KEY));try{n.map((function(e){return e.id})).forEach(function(){var t=e(i)(e(o).mark((function t(n){var a,r;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.fetchMovieById(n);case 2:a=e.sent,(r=a.genres.map((function(e){return e.name}))).length>2&&r.splice(2,r.length-1,"Other"),0===r.length&&r.push("Other"),s.library.insertAdjacentHTML("beforeend",p(a,r.join(", "))),s.library.lastElementChild.setAttribute("data-status","watched");case 8:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(e){Notify.failure("Ооps, something went wrong, please try again")}case 4:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}function b(){return b=e(i)(e(o).mark((function t(){var n,a;return e(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(0,l.spinnerPlay)(),s.library.innerHTML="",m(n=(0,f.load)(h.QUEUE_KEY)),a=n.map((function(e){return e.id}));try{a.forEach(function(){var t=e(i)(e(o).mark((function t(n){var a,r;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.fetchMovieById(n);case 2:a=e.sent,(r=a.genres.map((function(e){return e.name}))).length>2&&r.splice(2,r.length-1,"Other"),0===r.length&&r.push("Other"),s.library.insertAdjacentHTML("beforeend",p(a,r.join(", "))),s.library.lastElementChild.setAttribute("data-status","queue");case 8:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(e){console.log(e),Notify.failure("Ооps, something went wrong, please try again")}finally{(0,l.spinnerStop)()}case 6:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}function w(){return(w=e(i)(e(o).mark((function t(n){var a,r,i;return e(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.target.closest(".gallery__item"),e.prev=1,(0,l.spinnerPlay)(),r=a.dataset.id,i=a.dataset.status,e.next=7,h.fetchMovieById(r).then((function(e){var t=e.poster_path?"https://image.tmdb.org/t/p/w300".concat(e.poster_path):"https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png",n=new Date(Date.parse(e.release_date)).getFullYear(),o={id:e.id,poster:t,title:e.title,originalTitle:e.original_title,genres:[],popularity:e.popularity.toFixed(1),overview:e.overview,vote_average:e.vote_average.toFixed(1),vote_count:e.vote_count,release_date:n};e.genres.forEach((function(e){o.genres.push(e.name)})),o.genres=o.genres.join(", "),(0,v.getTrailer)(r,h),(0,d.createModalMarkUp)(o);var c=document.querySelector(".lightbox-modal__watched-button"),l=document.querySelector(".lightbox-modal__queque-button");c.addEventListener("click",(function(e){var t=e.target.dataset.btn;(0,f.removeLocal)(h.WATCH_KEY,t),e.target.textContent="Removed from Watched",e.target.disabled=!0,e.target.dataset.list===i&&a.remove();s.watchBtn.classList.contains("is-active-library")?m((0,f.load)(h.WATCH_KEY)):m((0,f.load)(h.QUEUE_KEY))})),l.addEventListener("click",(function(e){var t=e.target.dataset.btn;(0,f.removeLocal)(h.QUEUE_KEY,t),e.target.textContent="Removed from Queue",e.target.disabled=!0,e.target.dataset.list===i&&a.remove();s.watchBtn.classList.contains("is-active-library")?m((0,f.load)(h.WATCH_KEY)):m((0,f.load)(h.QUEUE_KEY))})),_(h.WATCH_KEY,o,c,"Remove from Watched","watched"),_(h.QUEUE_KEY,o,l,"Remove from Queue","queue")}));case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),Notify.failure("Ооps, something went wrong, please try again");case 13:return e.prev=13,(0,l.spinnerStop)(),e.finish(13);case 16:case"end":return e.stop()}}),t,null,[[1,9,13,16]])})))).apply(this,arguments)}function _(e,t,n,a,r){var i=(0,f.load)(e),o=t,s=i.find((function(e){return e.id===o.id}));s&&(n.dataset.list="".concat(r),n.textContent="".concat(a)),s||n.classList.add("visually-hidden")}s.watchBtn.addEventListener("click",(function(){s.queueBtn.classList.remove("is-active-library"),s.watchBtn.classList.add("is-active-library"),y()})),s.queueBtn.addEventListener("click",(function(){s.watchBtn.classList.remove("is-active-library"),s.queueBtn.classList.add("is-active-library"),function(){b.apply(this,arguments)}()})),s.library.addEventListener("click",(function(e){return w.apply(this,arguments)}))}();
//# sourceMappingURL=library.bdd17665.js.map
